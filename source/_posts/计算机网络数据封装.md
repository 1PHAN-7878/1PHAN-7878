---
title: 计算机网络数据封装
date: 2023-12-05 19:36:25
tags: 计算机网络
---

实验十、数据封装实验

# 一、实验目的

1.回顾静态路由的配置方法，根据网络拓扑实现两台PC互通。

2.了解CISCO模拟器的simulation mode（模拟模式），观察网络数据包的来龙去脉。

3.掌握以太网帧的构成，了解各个字段的含义；

4．能够识别不同的MAC地址并理解MAC地址的作用；

5.掌握IP数据包的组成和网络层的基本功能；

6．理解ICMP协议与IP协议的封装关系。

# 二、实验内容

1．安装CISCO模拟器；

2．画出网络拓扑图；

3．进行静态路由的配置；

4．测试网络的通信效果；

5.通过PING命令捕捉ICMP报文，观察ICMP协议与IP协议的封装关系。

# 三、实验原理

1．以太网帧结构。以太网中传输的数据包通常被称为“帧”，以太网的“帧”结构如下：

![image-20231205194155695](../images/image-20231205194155695.png)

各字段的含义：

目的地址：6个字节的目的物理地址标识帧的接收结点；

源地址：6个字节的源物理地址标识帧的发送结点；

帧类型/长度（TYPE/LEN）：该字段的值大于或等于0x0600时，表示上层数据使用的协议类型。例如0x0806表示ARP请求或应答，0x0800表示IP协议。该字段的值小于0x0600时表示以太网用户数据的长度字段，上层携带LLC-PDU；

数据字段：这是一个可变长度字段，用于携带上层传下来的数据；

帧校验FCS：以太网采用32位CRC冗余校验。校验范围是目的地址、源地址、长度/类型、数据字段。

 

2．IP数据报格式

![image-20231205194224831](../images/image-20231205194224831.png)


3.ICMP回显请求和应答报文格式

网络测试程序 Ping就是利用ICMP的回显请求报文完成的，回显请求报文的类型是8，代码是0。ICMP回显请求报文格式如下：

 ![image-20231205194233314](../images/image-20231205194233314.png)

# 四、实验步骤

1、画出拓扑图并配置各IP如下：

 ![image-20231205194241903](../images/image-20231205194241903.png)

2、仿照实验八，自行配置路由表，使得两台PC可以互相ping通。

3、观察数据包进出每个设备时的变化，截屏记录，并回答思考题。

注意：

1. 别忘打开路由器端口，特别是在图形界面上操作时

2. 在路由器上可以ping通，PC还是ping不同，why？没有设置网关。

3.将模拟器调到模拟模式，在PC0的桌面上运行ping命令，ping PC1，点击Auto capture，观察ICMP协议过程。要了解协议的详细信息，可单击显示不同颜色的协议类型信息Info。从而看到OSI模型信息和各层PDU信息。

# 五、 思考问题

结合实验过程中的实验结果，回答下列问题：

1．IP数据包在从源主机出发到达目的主机的过程中，IP首部中的IP源地址和目的地址字段是否发生变化？

IP首部的IP地址并没有发生变化。

2.以太网数据帧中的MAC地址是否发生了变化？

MAC地址发生了变化

3.协议之间是怎样进行数据封装的？请结合TCP/IP模型或OSI模型说明本次实验中数据传输的过程。

1. **应用层（Application Layer）**：
   - 发送端：应用层负责生成应用层数据，并将其传递给传输层。例如，在HTTP中，这可能是一个HTTP请求。
   - 接收端：应用层接收传输层的数据，然后将其传递给上层应用。
2. **传输层（Transport Layer）**：
   - 发送端：传输层负责将上层数据分割为适当的大小，管理数据的流动，并添加传输层的首部信息。在TCP中，这包括源端口、目标端口、序列号等。
   - 接收端：传输层接收底层数据，去除传输层的首部，然后将其传递给上层。
3. **网络层（Network Layer）**：
   - 发送端：网络层添加网络层的首部，包括源IP地址和目标IP地址等。这个包含了数据从一个节点到另一个节点的路径信息。
   - 接收端：网络层接收数据，去除网络层的首部，然后将其传递给传输层。
4. **数据链路层（Data Link Layer）**：
   - 发送端：数据链路层添加数据链路层的首部，通常包括物理地址（MAC地址）等信息。
   - 接收端：数据链路层接收数据，去除数据链路层的首部，然后将其传递给网络层。
5. **物理层（Physical Layer）**：
   - 发送端：物理层将数据转化为比特流，通过物理媒体传输。
   - 接收端：物理层接收比特流，然后将其传递给数据链路层。

![image-20231205194429709](../images/image-20231205194429709.png)

![image-20231205194436611](../images/image-20231205194436611.png)

![image-20231205194442373](../images/image-20231205194442373.png)

![image-20231205194447888](../images/image-20231205194447888.png)

![image-20231205194452895](../images/image-20231205194452895.png)

![image-20231205194457344](../images/image-20231205194457344.png)
